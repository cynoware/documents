<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../sdk.css" />
<link rel="stylesheet" href="../styles/foundation.css" />
<script src="../highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<ul id='main'>
	<li><div class='title'>枚举值</div>
		<pre><code class='c'>typedef enum {
    kTriggerMode_PressKey   = '\x00',
    kTriggerMode_Continuous = '\x01',
    kTriggerMode_Auto       = '\x02',
    kTriggerMode_Respond    = '\x03',
    kTriggerMode_Wave       = '\x04',
} TriggerMode;</code></pre>
	</li>
	<li><div class='title'>函数</div>
		<ul>	
			<li><div class='funcname'>scan</div>
				<div class='description'>
					开启二维码扫描读取数据
				</div>
				<dl>
					<dt>device</dt><dd>指向PosMate设备的指针</dd>
					<dt>uart</dt><dd>uart序号</dd>
					<dt>buf</dt><dd>读出数据的缓冲区</dd>
					<dt>size</dt><dd>缓冲区大小</dd>
                    <dt>mode</dt><dd>触发模式</dd>
					<dt>返回</dt><dd>实际读出数据的长度</dd>
				<dl>
				<pre><code class='c'>int scan (Device *device, uint32_t uart, char *buf, size_t size, TriggerMode mode);</code></pre>
			</li>
			<li><div class='funcname'>scannerExists</div>
				<div class='description'>
					判断二维码扫描器的存在
				</div>
				<dl>
					<dt>device</dt><dd>指向PosMate设备的指针</dd>
					<dt>uart</dt><dd>uart序号</dd>
					<dt>返回</dt><dd>是否存在二维码设备</dd>
				</dl>
				<pre><code class='c'>BOOL scannerExists (Device *device, uint32_t uart);</code></pre>
			</li>
			<li><div class='funcname'>stopScan</div>
				<div class='description'>
					停止扫描二维码
				</div>
				<dl>
					<dt>device</dt><dd>指向PosMate设备的指针</dd>
					<dt>uart</dt><dd>uart序号</dd>
					<dt>返回</dt><dd>保留</dd>
				</dl>
				<pre><code class='c'>int stopScan (Device *device, uint32_t uart);</code></pre>
			</li>
			<li><div class='funcname'>setScanTriggerMode</div>
				<div class='description'>
					设置扫码器的触发条件
				</div>
				<dl>
					<dt>device</dt><dd>指向PosMate设备的指针</dd>
					<dt>uart</dt><dd>uart序号</dd>
                    <dt>mode</dt><dd>触发模式</dd>
					<dt>返回</dt><dd>保留</dd>
				<dl>
				<pre><code class='c'>int setScanTriggerMode(Device *device, uint32_t uart, TriggerMode mode);</code></pre>
			</li>
		</ul>
	</li>
	<li><div class='title'>示例代码</div>
		<pre><code class='c'>int mainScanStart(int deviceMask, int argc, char **argv) {
    Device *device = deviceNew();
    deviceMask = deviceDetect(device, deviceMask);
    int uart = (deviceMask == DEVICE_DETECT_FRAME_USB ?
        CONFIG_FRAME_QRREADER_UART : CONFIG_DOCK_QRREADER_UART);

    if (scannerExists(device, uart)) {
        char result[512];
        int size;

        setScanTriggerMode(device, uart, kTriggerMode_Respond);
        //setScanBeep(device, uart, 2);

        while (1) {
            size = scan(device, uart, result, sizeof(result), kTriggerMode_Respond);
            if (size < 0)
                break;
            else if (size == 0)
                continue;
            else {
                keyboardInputString(device, result);
                keyboardInputString(device, "\n");
            }
        }
    }
    deviceFree(device);
    return 0;

    return EXIT_SUCCESS;
}</code></pre>
	</li>
</ul>
</body>
</html>
