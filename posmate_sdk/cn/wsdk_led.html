<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../sdk.css" />
<link rel="stylesheet" href="../styles/foundation.css" />
<script src="../highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<ul id='main'>
	<li><div class='title'>简介</div>
		可以使用UART驱动LED客显，通常只要先设定好UART输出波特率，
		然后按照LED的指令文档，输出显示指令就可以了。<br />
		（以下代码仅做示例，针对不同的LED，波特率和指令系统可能不同。）<br />
		&nbsp;<br />
	</li>
	<li><div class='title'>示例代码</div>
		<pre><code class='c'>#include "posmate.h"
#include "config.h"

//Example of LED --
//  mainLed1, control LED type 1
//  mainLed2, control LED type 2

int mainLed1(int deviceMask, int argc, char **argv){
    Device *device = deviceNew();
    deviceDetect(device, deviceMask);

    if(deviceGetRawDevice(device) != NULL){
        uartSetConfig(device, CONFIG_LED_UART, 9600, 8, UARTParity_None, UARTStopBits_1);
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x40", 2);	//command: init
        if(argc <= 2){
            const char *str = "No argument";
            uartFixedWrite(device, CONFIG_LED_UART, str, strlen(str));
        }
        else{
            int i;
            for(i = 2; i < argc; ++i){
                uartFixedWrite(device, CONFIG_LED_UART, argv[i], strlen(argv[i]));
                if((i + 1) < argc)
                    uartFixedWrite(device, CONFIG_LED_UART, " ", 1);
            }
        }
        uartFixedWrite(device, CONFIG_LED_UART, "\x0D", 1);		//command: show end
    }
    deviceFree(device);
    return 0;
}


int mainLed2(int deviceMask, int argc, char **argv){
    Device *device = deviceNew();
    deviceDetect(device, deviceMask);

    if(deviceGetRawDevice(device) != NULL){
        uartSetConfig(device, CONFIG_LED_UART, 2400, 8, UARTParity_None, UARTStopBits_1);
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x40", 2);    //command: init
        uartFixedWrite(device, CONFIG_LED_UART, "\x0C", 1);	    //command: clear
        xsleep(500);
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x73\x31", 3);//show "PRICE"
        xsleep(500);
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x73\x32", 3);//show "TOTAL"
        xsleep(500);
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x73\x33", 3);//show "RECEIVIE"
        xsleep(500);
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x73\x34", 3);//show "CHANGE"
        xsleep(500);
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x73\x30", 3);//shut off
        xsleep(200);
        
        uartFixedWrite(device, CONFIG_LED_UART, "\x1B\x51\x41", 3);//start to display text
        xsleep(100);

        if(argc <= 2){
            const char *str = "1234.5678";
            uartFixedWrite(device, CONFIG_LED_UART, str, strlen(str));

			xsleep(100);
			const char *str1 = "4543.6543";
			uartFixedWrite(device, CONFIG_LED_UART, str1, strlen(str1));

			xsleep(100);
			const char *str2 = "2123.4578";
			uartFixedWrite(device, CONFIG_LED_UART, str2, strlen(str2));
        }
        else{
            int i;
            for(i = 2; i < argc; ++i){
                uartFixedWrite(device, CONFIG_LED_UART, argv[i], strlen(argv[i]));
                if((i + 1) < argc)
                    uartFixedWrite(device, CONFIG_LED_UART, " ", 1);
            }
        }
        uartFixedWrite(device, CONFIG_LED_UART, "\x0D", 1);		//command: show end        
    }
    deviceFree(device);
    return 0;
}</code></pre>
	</li>
</ul>
</body>
</html>
